---
import Layout from '../layouts/Layout.astro';
---

<Layout>
  <div class="signup-container">
    <div class="sign-up">
      <div class="back">
        <img src="src/assets/back.svg" alt="back" class="back-icon">
        <p>Back</p>
      </div>
      <form class="signup-form">
        <label>
          <span>Username</span>
          <input type="text" name="username" autocomplete="off" class="username" required placeholder="input your username">
        </label>
        <label>
          <span>E-mail address</span>
          <input type="text" name="email" placeholder="exaple@gmail.com" id="email" required>
        </label>
        <label>
          <span>Password</span>
          <input type="password" name="password" placeholder="input your password" class="password" required>
        </label>
        <label>
          <span>Icon</span>
            <ul class="icon">
              <li><img src="src/assets/1.png" alt="angel"></li>
              <li><img src="src/assets/2.png" alt="elf"></li>
              <li><img src="src/assets/3.png" alt="madoshi"></li>
              <li><img src="src/assets/4.png" alt="night"></li>
              <li><img src="src/assets/5.png" alt="monster"></li>
            </ul>
        </label>
        <button type="submit">Sign Up</button>
      </form>
    </div>
  </div>
</Layout>
<script>
  document.addEventListener('DOMContentLoaded', () => {
		const backBtn = document.querySelector('.back') as HTMLButtonElement;

    backBtn.addEventListener('click', () => {
      window.location.href = '/'; 
    });

    const signupForm = document.querySelector('.signup-form') as HTMLFormElement

    signupForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const signupFormData = new FormData(signupForm);
      const username = signupFormData.get('username');
      const email = signupFormData.get('email');
      const password = signupFormData.get('password');
      const imageNum= signupFormData.get('imageNum');

		console.log(JSON.stringify({ username, email, password, imageNum }));

    try{
      const response = await fetch(`http://localhost:3001/register`, {
			method: 'POST',
			headers: {
				"Content-Type": 'application/json',
			},
			body: JSON.stringify({
				"username": username,
				"email": email,
				"password": password,
        "imageNum":imageNum
			}),
			credentials: 'include'
		});

  } catch (error) {
    console.error('Error:', error);
    alert('Something went wrong. Please try again later.');
  }	
	});

	})
</script>
<style>
  .signup-container{
    display: flex;
		padding: 8px;
    margin:0 auto;
    align-items: center;
		justify-content: center;
    height:95vh;
    background-image: url('/src/assets/signup.jpg');
		background-size: cover;
		background-position: center;
    font-family: "VT323", monospace;
    font-weight: bold;
	}

  .signup-form {
    display: flex;
    flex-direction: column;
    gap: 15px; 
    padding:40px;
    padding-top:16px;
    width: 520px;
    border: 3px solid black;
    background-color: white;
  }

 label {
  display: flex;
  flex-direction: column;
	margin-bottom: 16px;
}

 span{
	margin-bottom: 8px;
  font-size:1.2rem;
}

input{
	padding:16px;
  border: 3px solid black;
}

.signup-form button{
	width:100%;
	background-color:#2c2c2c;
	color:white;
	border-radius: 10px;
  cursor: pointer;
  padding:10px;
  font-size:1.2rem;
  box-shadow:2px 2px 0 2px black;
}

.signup-form button:hover{
  transform: translateY(4px);
  box-shadow: none;
  background-color: white;
  color: black;
}

.back{
	display:flex;
}

.back p{
  font-size:1.5rem;
}

.back-icon{
	width:30px;
  height:24px;
	cursor: pointer;
  margin-top:5px;
  padding-right:10px;
}

.icon {
 display: flex;
 padding:0;
 justify-content: space-between;
}

.icon li{
  list-style: none;
  cursor: pointer;
}

.icon li:hover{
  scale:calc(1.2)
}

.icon li img{
  width:80px;
}

.icon li:nth-child(n+2):nth-child(-n+4) img{
  width: 40px;
}

</style>